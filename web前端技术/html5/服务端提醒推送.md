# 服务端提醒推送

以往的网页提示仅限在浏览器中,而html5现在支持桌面级的通知,也就是web notification,这一特性非常适合浏览器端的音乐app.又或者是邮件app,如果结合后面的websocket或者socket.io,更是可以用来做im

web notification的用法也简单

首先,由于浏览器权限问题,我们需要向用户请求开通web notification功能

```js
Notification.requestPermission((status)=>{  
    //status是授权状态，如果用户允许显示桌面通知，则status为'granted'  
    console.log('status: ' + status)
    //permission只读属性  
    let permission = Notification.permission
    //default 用户没有接收或拒绝授权请求 不能显示通知  
    //granted 用户接受授权请求 允许显示通知  
    //denied  用户拒绝授权请求 不允许显示通知  

    console.log('permission: ' + permission)
});  
```
当这段代码执行时，浏览器会询问用户，是否允许该站点显示消息通知

接着就是使用了:

```js
if (Notification.permission === 'granted') {  
    //show notification
    let n = new Notification("sir, you got a message", {  
        icon: 'img/icon.png',  
        body: 'you will have a meeting 5 minutes later.'  
    })
}  

```

Notification本身还支持添加交互,它有4个常用的函数可以用来处理事件交互:

+ onshow函数可以在消息展示时执行
+ onclick函数可以在用户点击消息后被调用
+ onclose函数是在消息框被关闭时被调用
+ onerror函数是发生错误时被调用

上面也提到了，如果没有被授权而继续创建消息通知，也会执行onerror函数。掌握了这几个函数的应用，基本上可以很好地处理消息事件了

需要注意的是

1. typescript目前的2.1版本并没有支持这一特性,在2.2中才会被添加进来,因此我们要先申明它的[接口].
2. 通知功能需要浏览器中打开,默认是被阻止的,chrome中在高级设置中打开
